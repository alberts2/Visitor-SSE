hjust = -0.5, size = 2)
# add coverage stats
f_coverage = round( sum(df_dat_i$covered) / nrow(df_dat_i), digits=3)
f_label = paste0("HPD", round(coverage*100,digits=0), ": ", f_coverage)
p = p + annotate("text", x=-Inf, y=Inf, label=f_label, vjust=2, hjust=0)
# plot labels & title
p = p + xlab("true") + ylab("estimate")
p = p + ggtitle(param)
plot_list[[i]] = p
# save figure
plot_fn = paste0(plot_fp, "/plot_coverage_", param, ".pdf")
print(plot_fn)
pdf(plot_fn, height=7, width=7)
print(p)
dev.off()
}
#
#
plot_list[[1]]
plot_list[[2]]
plot_list[[3]]
plot_list[[4]]
plot_list[[5]]
plot_list[[6]]
#############
# LIBRARIES #
#############
library(ggplot2)
library(HDInterval)
library(rjson)
library(data.table)
library(ape)
##############
# SETTINGS   #
##############
equal_rates = TRUE
#Set coverage level for credible intervals
coverage = 0.80
# coverage = 0.95
# "Infect" <-> "lambda"
#Define parameter names for simulation, inference and their dimensions
sim_names = c("R0", "Sample", "log_VisitDepart", "log_VisitReturn")
inf_names = c("R_0", "delta", "vd_rate", "vr_rate")
dim = c(1, 1, 2, 2)
param_names = data.frame(sim=sim_names, inf=inf_names, dim=dim)
##############
# FILESYSTEM #``
##############
#filepaths for project directories
fp = "/Users/albertsoewongsono/Documents/Code Testing/visitor_sse"
# out_inf_fp = paste0(fp, "/output/logs/3_locations/log_sim7/visitor/survival") # sim7 with survival condition and 3 locs
# out_inf_fp = paste0(fp, "/output/logs/3_locations/log_sim8/visitor/survival") # sim8 with survival condition and 3 locs
# out_inf_fp = paste0(fp, "/output/logs/3_locations/log_sim9/visitor/survival") # sim9 with survival condition and 3 locs
#
# out_inf_fp = paste0(fp, "/output/logs/4_locations/log_sim7_4loc/visitor/survival") # sim7 with survival condition and 4 locs
# out_inf_fp = paste0(fp, "/output/logs/4_locations/log_sim8_4loc/visitor/survival") # sim8 with survival condition and 4 locs
# out_inf_fp = paste0(fp, "/output/logs/4_locations/log_sim9_4loc/visitor/survival") # sim9 with survival condition and 4 locs
#
# out_inf_fp = paste0(fp, "/output/logs/5_locations/log_sim7_5loc/visitor/survival") # sim7 with survival condition and 5 locs
# out_inf_fp = paste0(fp, "/output/logs/5_locations/log_sim8_5loc/visitor/survival") # sim8 with survival condition and 5 locs
# out_inf_fp = paste0(fp, "/output/logs/5_locations/log_sim9_5loc/visitor/survival") # sim9 with survival condition and 5 locs
#
# out_inf_fp = paste0(fp, "/output/logs/3_locations/log_sim7/visitor/tree_extant") # sim7 with tree_extant condition and 3 locs
# out_inf_fp = paste0(fp, "/output/logs/3_locations/log_sim8/visitor/tree_extant") # sim8 with tree_extant condition and 3 locs
# out_inf_fp = paste0(fp, "/output/logs/3_locations/log_sim9/visitor/tree_extant") # sim9 with tree_extant condition and 3 locs
#
# out_inf_fp = paste0(fp, "/output/logs/4_locations/log_sim7_4loc/visitor/tree_extant") # sim7 with tree_extant condition and 4 locs
# out_inf_fp = paste0(fp, "/output/logs/4_locations/log_sim8_4loc/visitor/tree_extant") # sim8 with tree_extant condition and 4 locs
# out_inf_fp = paste0(fp, "/output/logs/4_locations/log_sim9_4loc/visitor/tree_extant") # sim9 with tree_extant condition and 4 locs
#
# out_inf_fp = paste0(fp, "/output/logs/5_locations/log_sim7_5loc/visitor/tree_extant") # sim7 with tree_extant condition and 5 locs
# out_inf_fp = paste0(fp, "/output/logs/5_locations/log_sim8_5loc/visitor/tree_extant") # sim8 with tree_extant condition and 5 locs
out_inf_fp = paste0(fp, "/output/logs/5_locations/log_sim9_5loc/visitor/tree_extant") # sim9 with tree_extant condition and 5 locs
#
# out_sim_fp = paste0(fp,"/data/sim7")  # dataset 7 3 locations (vr_rate > vd_rate)
# out_sim_fp = paste0(fp,"/data/sim8")  # dataset 8 3 locations (vr_rate = vd_rate)
# out_sim_fp = paste0(fp,"/data/sim9")  # dataset 9 3 locations (vr_rate < vd_rate)
#
# out_sim_fp = paste0(fp,"/data/sim7_4loc")  # dataset 7 4 locations (vr_rate > vd_rate)
# out_sim_fp = paste0(fp,"/data/sim8_4loc")  # dataset 8 4 locations (vr_rate = vd_rate)
# out_sim_fp = paste0(fp,"/data/sim9_4loc")  # dataset 9 4 locations (vr_rate < vd_rate)
#
# out_sim_fp = paste0(fp,"/data/sim7_5loc")  # dataset 7 5 locations (vr_rate > vd_rate)
# out_sim_fp = paste0(fp,"/data/sim8_5loc")  # dataset 8 5 locations (vr_rate = vd_rate)
out_sim_fp = paste0(fp,"/data/sim9_5loc")  # dataset 9 5 locations (vr_rate < vd_rate)
plot_fp = paste0(fp, "/scripts/plot")
# Define replicate indicies
# rep_idx = 1:328 # For replicate 0 to 200 in RIS
# rep_idx = 1:347 # For replicate 0 to 200 in RIS
# rep_idx = 1:342 # For replicate 0 to 200 in RIS
# rep_idx = 1:358 # For replicate 0 to 200 in RIS
rep_idx = 1:370 # For replicate 0 to 200 in RIS
#Create full file path for  simulation and inference data files
# sim_files = paste0(out_sim_fp, "/sim.", rep_idx-1, ".param_col.csv")
sim_files = paste0(out_sim_fp, "/sim.", rep_idx-1, ".param_col.csv")
inf_files = paste0(out_inf_fp, "/out.idx_", rep_idx-1, ".seed_5.model.json")
sim_files = sort(sim_files)
inf_files = sort(inf_files)
###################
# DATA PROCESSING #
###################
# get file index for files
sim_idx = as.numeric( sapply(sim_files, function(x) { y=strsplit(x,split="\\.")[[1]][2] }) )
inf_idx = sapply(inf_files, function(x) { y=strsplit(x,split="\\.")[[1]][2] })
inf_idx = as.numeric(sapply(inf_idx, function(x) { y=strsplit(x, split="_")[[1]][2] }))
# store failed runs
fail_runs = c()
# match files by index
#store data for each replicate
#rep_dat = matrix(NA, nrow=0, ncol=6)
#colnames(rep_dat) = c("variable", "true", "mean", "lower95", "upper95", "covered")
rep_dat_list = list()
rep_dat_idx = 1
#loop through each replicate index
for (i in rep_idx) {
# check that index match
# (better: check that files exist and share index name)
if (!((i-1) %in% sim_idx && (i-1) %in% inf_idx)) {
warning("cannot find replicate", i-1)
break
}
# check that both inference file and simulation file for index i exist
if (file.exists(sim_files[i]) && file.exists(inf_files[i]) == FALSE){
warning("inference file out.idx_", inf_idx[i]," not exist")
fail_runs <- append(fail_runs,inf_idx[i])
next # skip to the next sample
}
# browser()
if (file.exists(sim_files[i]) && file.exists(inf_files[i]) == TRUE){
#Print out progress
cat("Processing ", i, " of ", length(rep_idx), "\n", sep="")
# prepare matrix for replicate i
rep_dat_i = matrix(NA, nrow=nrow(param_names)+2, ncol=7)
colnames(rep_dat_i) = c("variable", "idx",  "true", "mean", "lower", "upper", "covered")
rep_dat_i[,1] = c(param_names$sim,"log_ratio_depart_return","ratio_pii_pij")
# rep_dat_i[,2] = i-1
# Label the tree index according to the file index that passes the check
rep_dat_i[,2] = inf_idx[i]
# read simulation files
sim_dat = read.csv(sim_files[i], sep=",")
# sim_dat_i[,2] = c(
#     sim_dat$value[sim_dat$param=="R0_0"],
#     sim_dat$value[sim_dat$param=="Sample_0"],
#     sim_dat$value[sim_dat$param=="VisitDepart_0_0"],
#     sim_dat$value[sim_dat$param=="VisitReturn_0_0"]
# )
# read inference files
inf_dat = readLines(inf_files[i])
num_lines = length(inf_dat)
inf_json_list = list()
json_idx = 1
for (j in 1:num_lines) {
if (j == 1) {
next
}
inf_json_list[[json_idx]] = rjson::fromJSON(json_str=inf_dat[j])
json_idx = json_idx + 1
}
for (j in 1:(nrow(param_names)+2)) {
#calculate mean and HPD intervals for inferred parameter
if (j != 5 && j != 6){
# get param name
p_sim_base = param_names$sim[j]
p_sim_idx = paste0( rep("_0", param_names$dim[j]), collapse="")
p_sim = paste0(p_sim_base, p_sim_idx)
p_inf = param_names$inf[j]
#
p_mean  = mean(unlist(lapply( inf_json_list, function(x) { x[[p_inf]][1] } )))
p_hpd   = HDInterval::hdi(unlist(lapply( inf_json_list, function(x) { x[[p_inf]][1] } )), credMass=0.80)
p_true  = sim_dat$value[sim_dat$param==p_sim]
} else if (j == 5){
# get param name
p_sim_base = "log_ratio_depart_return"
#
inf_vd = unlist(lapply( inf_json_list, function(x) { x[["vd_rate"]][1] } ))
inf_vr = unlist(lapply( inf_json_list, function(x) { x[["vr_rate"]][1] } ))
p_mean = mean(inf_vd-inf_vr)
p_hpd   = HDInterval::hdi(inf_vd-inf_vr, credMass=0.80)
p_true  = sim_dat$value[sim_dat$param=="log_VisitDepart_0_0"]-sim_dat$value[sim_dat$param=="log_VisitReturn_0_0"]
} else if (j == 6){
# get param name
p_sim_base = "ratio_pii_pij"
#
inf_pii = unlist(lapply( inf_json_list, function(x) { x[["P"]][[1]][1] } )) #take P_11
inf_pij = unlist(lapply( inf_json_list, function(x) { x[["P"]][[1]][2] } )) #take P_12
p_mean  = mean(inf_pii/inf_pij)
p_hpd   = HDInterval::hdi(inf_pii/inf_pij, credMass=0.80)
p_true  = sim_dat$value[sim_dat$param=="VisitStationaryFreqs_0_0"]/sim_dat$value[sim_dat$param=="VisitStationaryFreqs_0_1"]
}
p_lower = p_hpd[1]
p_upper = p_hpd[2]
p_cover = (p_true <= p_upper && p_true >= p_lower)
#store results in matrix
rep_dat_i[ rep_dat_i[,1] == p_sim_base, 3:ncol(rep_dat_i) ] = c(
p_true, p_mean, p_lower, p_upper, p_cover
)
}
#add results from replicate into single data frame
rep_dat_list[[rep_dat_idx]] = data.frame(rep_dat_i)
rep_dat_idx = rep_dat_idx + 1
}
}
# set types for columns in the dataframe
df_dat = rbindlist(rep_dat_list)
df_dat$idx = as.numeric(df_dat$idx)
df_dat$true = as.numeric(df_dat$true)
df_dat$mean = as.numeric(df_dat$mean)
df_dat$lower = as.numeric(df_dat$lower)
df_dat$upper = as.numeric(df_dat$upper)
df_dat$covered = as.logical(as.numeric(df_dat$covered))
# Sort the data frame according to its index
df_dat = df_dat[order(idx)]
# Get the tree size from each tree
tree_size <- c()
idx_list <-  df_dat$idx
for (i in 1:length(idx_list)){
tree_name <- paste0(out_sim_fp, "/sim.", idx_list[i], ".tre")
tree_file <- read.tree(tree_name)
tree_size <- append(tree_size,length(tree_file$tip.label))
}
# Append to the dataframe
df_dat$ntips <- tree_size
data_sample <- df_dat[which(df_dat$variable %in% "Sample")]
# Filter the dataframe to only include HPDs from trees with size bigger than or equal to 24
# df_dat <- subset(df_dat,df_dat$ntips >= 24)
# df_dat <- subset(df_dat,df_dat$ntips == 499)
# df_dat <- subset(df_dat,df_dat$ntips <= 20)
# df_dat <- subset(df_dat,df_dat$ntips > 10)
# df_dat <- subset(df_dat,df_dat$ntips < 499)
#
# Sort by false vs true covered from filtered dataset by tree size
df_dat_false <- df_dat[which(df_dat$variable %in% "R0" & df_dat$covered == FALSE)]
df_dat_true <- df_dat[which(df_dat$variable %in% "R0" & df_dat$covered == TRUE)]
# plotting
plot_list = list()
#loop for each parameter
for (i in 1:(nrow(param_names)+2)) {
# get dataset for parameter
if (i != 5 && i != 6){
param = param_names$sim[i]
df_dat_i = df_dat[ df_dat$variable==param, ]
} else if (i == 5){
param = "log_ratio_depart_return"
df_dat_i = df_dat[ df_dat$variable==param, ]
} else if (i == 6){
param = "ratio_pii_pij"
df_dat_i = df_dat[ df_dat$variable==param, ]
}
# make plot
p = ggplot( df_dat_i, aes(x=true, y=mean) )
# plot 1:1 line
p = p + geom_abline(intercept=0, slope=1, lty=2, color="gray")
# plot true vs. mean points
p = p + geom_point()
# plot HPD segments
p = p + geom_segment(data = df_dat_i,
mapping=aes(x=true, xend=true, y=lower, yend=upper, color=covered))
# add text for the number of tips for each HPD
p = p + geom_text(aes(label = ntips),
hjust = -0.5, size = 2)
# add coverage stats
f_coverage = round( sum(df_dat_i$covered) / nrow(df_dat_i), digits=3)
f_label = paste0("HPD", round(coverage*100,digits=0), ": ", f_coverage)
p = p + annotate("text", x=-Inf, y=Inf, label=f_label, vjust=2, hjust=0)
# plot labels & title
p = p + xlab("true") + ylab("estimate")
p = p + ggtitle(param)
plot_list[[i]] = p
# save figure
plot_fn = paste0(plot_fp, "/plot_coverage_", param, ".pdf")
print(plot_fn)
pdf(plot_fn, height=7, width=7)
print(p)
dev.off()
}
#
#
plot_list[[1]]
plot_list[[2]]
plot_list[[3]]
plot_list[[4]]
plot_list[[5]]
plot_list[[6]]
exp(0.5)
exp(0.8)
exp(0.8+0.5*(âˆ’0.67))
exp(0.8+0.5*(-0.67))
exp(0.8+sqrt(0.5)*(-0.67))
exp(0.8+sqrt(0.5)*(0.67))
3.574272-1.385746
setwd("/Users/albertsoewongsono/Documents/Code Testing/visitor_sse/data/emp")
test = write.nexus.data("location_A2.csv")
test = write.nexus.data("location_A2.csv")
data(woodmouse)
woodmouse
data = read.table("location_A2.csv")
View(data)
test = write.nexus.data(data,format = "standard")
test = write.nexus.data(data,file="test.nex",format = "standard")
?read.table
data = read.table("location_A2.csv",header = TRUE)
View(data)
data = read.csv("location_A2.csv",header = TRUE)
View(data)
test = write.nexus.data(data,file="test.nex",format = "standard")
?write.nexus.data
test = write.nexus.data(data,file="test.nex",format = "standard",datablock = FALSE)
test = write.nexus.data(data,file="test.nex",format = "standard",interleaved = FALSE,datablock = FALSE)
test = write.nexus.data(data,file="test.dat.nex",format = "standard",interleaved = FALSE,datablock = FALSE)
View(data)
library(phytools)
?writeNexus()
test = writeNexus(data,file = "test.nex")
data = read.csv("location_A2.csv",header = FALSE)
test = write.nexus.data(data,file="test.dat.nex",format = "standard",interleaved = FALSE,datablock = FALSE)
nexus_dat <- read.nexus("A2.dat.nex")
?read.nexus
nexus_dat <- read.nexus.data("A2.dat.nex")
View(nexus_dat)
nexus_dat$1
nexus_dat[,1]
length(nexus_dat)
nexus_dat[[1]]
View(nexus_dat)
nexus_dat[[]]
names(nexus_dat)
str(names(nexus_dat))
replace(names(nexus_dat)[1:5],c("A","B","C","D","E"))
names(nexus_dat)[1:5] <- c("A","B","C","D","E")
nexus_dat
View(nexus_dat)
data = read.csv("location_A2.csv",header = FALSE)
View(nexus_dat)
View(data)
data = read.csv("location_A2.csv",header = TRUE)
data$species
as.character(data$species)
data = read.csv("location_A2.csv",header = TRUE)
nexus_dat <- read.nexus.data("A2.dat.nex")
names(nexus_dat) <- as.character(data$species)
View(nexus_dat)
write.nexus.data(nexus_dat,"test.dat.nex")
tree.A2 <- read.tree("nadeau_A2.location_tree.tre")
?read.tree
tree.A2 <- read.nexus.data("nadeau_A2.location_tree.tre")
View(tree.A2)
names(tree.A2)
names(tree.A2) <-  as.character(data$species)
View(tree.A2)
write.nexus.data(tree.A2,"nadeau_A2.location_tree.tre")
View(tree.A2)
write.tree(tree.A2,"nadeau_A2.location_tree.tre")
tree.A2 <- read.tree("nadeau_A2.location_tree.tre")
tree.A2 <- read.tree("nadeau_A2.location_tree.tre")
?read.tree
tree.A2 <- read.tree("nadeau_A2.location_tree.tre",keep.multi = TRUE)
tree.A2 <- read.nexus("nadeau_A2.location_tree.tre")
View(tree.A2)
tree.A2$tip.label
tree.A2$tip.label <-  as.character(data$species)
write.tree(tree.A2,"nadeau_A2.location_tree.tre")
View(tree.A2)
?write.nexus
write.nexus.data(tree.A2,"test.tre")
View(tree.A2)
write.tree(tree.A2,"nadeau_A2.location_tree.tre")
setwd("/Users/albertsoewongsono/Documents/Code Testing/visitor_sse/data/emp/old")
tree.A3 <- read.nexus.data("nadeau_A2.location_tree.tre")
View(tree.A3)
tree.A3[1]
?read.nexus.data
?read.nexus
sqrt(1+4*4.670774/(365^2))
(sqrt(1+4*4.670774/(365^2))+1)/2
ln((sqrt(1+4*4.670774/(365^2))+1)/2)
log(10)
log((sqrt(1+4*4.670774/(365^2))+1)/2)
sigma2=log((sqrt(1+4*4.670774/(365^2))+1)/2)
(exp(sigma2)-1)*exp(2*log(365)+sigma2)
?read.tree
tree = read.tree("(sp.2:1,(sp.4:1,(sp.6:1,sp.7:1):1):1):1")
tree = read.tree(text="(sp.2:1,(sp.4:1,(sp.6:1,sp.7:1):1):1):1")
plot(tree)
plot(tree[1])
tree
tree = read.tree(text="(sp.2:1,(sp.4:1,(sp.6:1,sp.7:1):1):1):1;")
plot(tree)
write.tree
tree = read.tree(text="sp1:1;")
tree = read.tree(text="(sp1:1);")
plot(tree)
tree = read.tree(text="((sp.4:0.015973537957025163,sp.5:0.015973537957025163):0.39321966294362876,sp.3:0.4091932009006539):0.5908067990993461;")
plot(tree)
plot(tree)
tree
plot(tree)
sigma2
sigma2=log((sqrt(1+4*(4.670774*365^2)/(365^2))+1)/2)
sigma2
(exp(sigma2)-1)*exp(2*log(365)+sigma2)
(exp(sigma2)-1)*exp(2*log(365)+sigma2)/(365^2)
?rlnorm
log(2)
dat <- rlnorm(1000,1/log(365),(ln((1+(1+4*variance_nadeau/(365^2))^0.5)/2))^0.5)
dat <- rlnorm(1000,1/log(365),(log((1+(1+4*variance_nadeau/(365^2))^0.5)/2))^0.5)
vd_mu = 0       # mu parameter of the distribution in year (from Nadeau's)
vd_sd = 1^0.5   # sigma parameter of the distribution in year (from Nadeau's)
variance_nadeau = ((exp(vd_sd^2) - 1) * exp(2*vd_mu + vd_sd^2))*365^2 # variance of the distribution (from Nadeau's) in days^2
dat <- rlnorm(1000,1/log(365),(log((1+(1+4*variance_nadeau/(365^2))^0.5)/2))^0.5)
hist(dat)
dev.off()
hist(dat)
mean(dat)
1/log(365)
vd_mu = 0       # mu parameter of the distribution in year (from Nadeau's)
vd_sd = 1^0.5   # sigma parameter of the distribution in year (from Nadeau's)
variance_nadeau = ((exp(vd_sd^2) - 1) * exp(2*vd_mu + vd_sd^2))*365^2 # variance of the distribution (from Nadeau's) in days^2
dat <- rlnorm(1000,log(365),(log((1+(1+4*variance_nadeau/(365^2))^0.5)/2))^0.5)
mean(dat)
log(365)
vd_mu = 0       # mu parameter of the distribution in year (from Nadeau's)
vd_sd = 1^0.5   # sigma parameter of the distribution in year (from Nadeau's)
variance_nadeau = ((exp(vd_sd^2) - 1) * exp(2*vd_mu + vd_sd^2))*365^2 # variance of the distribution (from Nadeau's) in days^2
dat <- rlnorm(1000,log(365),(log((1+(1+4*variance_nadeau/(365^2))^0.5)/2))^0.5)
exp(log(365)+log((1+(1+4*variance_nadeau/(365^2))^0.5)/2)
)
exp(log(365)+log((1+(1+4*variance_nadeau/(365^2))^0.5)/2)/2)
exp(log(365)+log((1+(1+4*variance_nadeau/(365^2))^0.5)/2)/2)/365
mean(dat)
vd_mu = 0       # mu parameter of the distribution in year (from Nadeau's)
vd_sd = 1^0.5   # sigma parameter of the distribution in year (from Nadeau's)
variance_nadeau = ((exp(vd_sd^2) - 1) * exp(2*vd_mu + vd_sd^2))*365^2 # variance of the distribution (from Nadeau's) in days^2
dat <- rlnorm(1000,log(365),(log((1+(1+4*variance_nadeau/(365^2))^0.5)/2))^0.5)
mean(dat)
exp(log(365)+log((1+(1+4*variance_nadeau/(365^2))^0.5)/2)/2)
vd_mu = 0       # mu parameter of the distribution in year (from Nadeau's)
vd_sd = 1^0.5   # sigma parameter of the distribution in year (from Nadeau's)
variance_nadeau = ((exp(vd_sd^2) - 1) * exp(2*vd_mu + vd_sd^2))*365^2 # variance of the distribution (from Nadeau's) in days^2
dat <- rlnorm(1000000,log(365),(log((1+(1+4*variance_nadeau/(365^2))^0.5)/2))^0.5)
mean(dat)
exp(log(365)+log((1+(1+4*variance_nadeau/(365^2))^0.5)/2)/2)
vd_mu = 0       # mu parameter of the distribution in year (from Nadeau's)
vd_sd = 1^0.5   # sigma parameter of the distribution in year (from Nadeau's)
variance_nadeau = ((exp(vd_sd^2) - 1) * exp(2*vd_mu + vd_sd^2))*365^2 # variance of the distribution (from Nadeau's) in days^2
dat <- rlnorm(1000000,log(1/365),(log((1+(1+4*variance_nadeau/(365^2))^0.5)/2))^0.5)
mean(dat)
(ln((1+(1+4*1*exp(-2*14))^0.5)/2))^0.5
(log((1+(1+4*1*exp(-2*14))^0.5)/2))^0.5
dat_2 <-  rlnorm(1000,log(1/14),(log((1+(1+4*1*exp(-2*14))^0.5)/2))^0.5)
mean(dat_2)
1/14
var(dat_2)
dat_2 <-  rlnorm(1000,log(1/14),1)
mean(dat_2)
median(dat_2)
1/14
var(dat_2)
var(dat_2)^0.5
plot(density(dat_2))
plot(density(log(dat_2)))
quantile(dat_2)
quantile(dat_2,probs = 0.25)
HDInterval::hdi(dat_2)
1/0.003999473
HDInterval::hdi(1/dat_2)
250.0329/365
1/0.401401001
dat_2 <-  rlnorm(1000,log(1/14),0.1)
HDInterval::hdi(dat_2)
1/0.05725994
1/0.08455788
dat_2 <-  rlnorm(1000,log(1/14),0.25)
HDInterval::hdi(dat_2)
1/0.04385135
1/0.10754033
dat_2 <-  rlnorm(1000,log(1/14),0.5)
HDInterval::hdi(dat_2)
1/0.01669285
1/0.16504352
dat_2 <-  rlnorm(1000,log(1/7),0.5)
HDInterval::hdi(dat_2)
1/0.04248054
1/0.32538581
dat_2 <-  rlnorm(1000,log(1/10),0.5)
HDInterval::hdi(dat_2)
1/0.02646306
1/0.25055675
vd_mu = 0       # mu parameter of the distribution in year (from Nadeau's)
vd_sd = 1^0.5   # sigma parameter of the distribution in year (from Nadeau's)
variance_nadeau = ((exp(vd_sd^2) - 1) * exp(2*vd_mu + vd_sd^2))*365^2 # variance of the distribution (from Nadeau's) in days^2
sqr_root = (1+4*variance_nadeau/365^2)^0.5
dat <- rlnorm(1000,log(1/365),(ln((1+sqr_root)/2))^0.5)
dat <- rlnorm(1000,log(1/365),(log((1+sqr_root)/2))^0.5)
HDInterval::hdi(dat)
1/0.0001394749
1/0.0145925634
median(dat)
variance(dat)
var(dat)
var(dat)*365^2
7169.749/365
68.52806/365
mean(dat)
1/mean(dat)
(1/mean(dat))/365
((1/mean(dat))/365)*12
dat_2 <-  rlnorm(1000,log(1/10),0.5)
1/mean(dat_2)
median(dat_2)
1/median(dat_2)
1/median(dat)
0.1877481*12
