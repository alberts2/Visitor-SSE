setwd("/Users/albertsoewongsono/Documents/Code Testing/visitor_sse/data/sim7")
########################
##### FILE SYSTEM ######
########################
fp = "/Users/albertsoewongsono/Documents/Code Testing/visitor_sse"
# out_sim_fp = paste0(fp,"/data/sim7_rescale")  # dataset 7 rescaled
out_sim_fp = paste0(fp,"/data/sim7_rescale100")  # dataset 7 rescaled by 100
rep_idx = 1:350
sim_files = paste0(out_sim_fp, "/sim.", rep_idx, ".tre")
sim_idx = c()
# Get indexes from all tree files that exist in the folder
for (i in 1:length(sim_files)){
if(file.exists(sim_files[i]) == TRUE){
sim_idx <- append(sim_idx,i)
} else {
next
}
}
# Rescale all branch lengths of each individual tree
for (i in 1:length(sim_idx)){
tree_scale <- read.tree(paste("sim.",sim_idx[i],".tre",sep = ""))
# Rescale edge lengths
tree_scale$edge.length <- tree_scale$edge.length*10
# Rescale the stem branch length
tree_scale$root.edge   <- tree_scale$root.edge*10
# Save the modified tree
write.tree(tree_scale,paste0(out_sim_fp,"/sim.",sim_idx[i],".tre"))
}
# Load packages
library(ape)
########################
##### FILE SYSTEM ######
########################
fp = "/Users/albertsoewongsono/Documents/Code Testing/visitor_sse"
# out_sim_fp = paste0(fp,"/data/sim7_rescale")  # dataset 7 rescaled
out_sim_fp = paste0(fp,"/data/sim7_rescale100")  # dataset 7 rescaled by 100
rep_idx = 1:350
sim_files = paste0(out_sim_fp, "/sim.", rep_idx, ".tre")
sim_idx = c()
# Get indexes from all tree files that exist in the folder
for (i in 1:length(sim_files)){
if(file.exists(sim_files[i]) == TRUE){
sim_idx <- append(sim_idx,i)
} else {
next
}
}
# Rescale all branch lengths of each individual tree
for (i in 1:length(sim_idx)){
tree_scale <- read.tree(paste("sim.",sim_idx[i],".tre",sep = ""))
# Rescale edge lengths
tree_scale$edge.length <- tree_scale$edge.length*10
# Rescale the stem branch length
tree_scale$root.edge   <- tree_scale$root.edge*10
# Save the modified tree
write.tree(tree_scale,paste0(out_sim_fp,"/sim.",sim_idx[i],".tre"))
}
sim_files
fp = "/Users/albertsoewongsono/Documents/Code Testing/visitor_sse"
# out_sim_fp = paste0(fp,"/data/sim7_rescale")  # dataset 7 rescaled
out_sim_fp = paste0(fp,"/data/sim7_rescale100")  # dataset 7 rescaled by 100
rep_idx = 1:350
sim_files = paste0(out_sim_fp, "/sim.", rep_idx, ".tre")
sim_idx = c()
# Get indexes from all tree files that exist in the folder
for (i in 1:length(sim_files)){
if(file.exists(sim_files[i]) == TRUE){
sim_idx <- append(sim_idx,i)
} else {
next
}
}
# Rescale all branch lengths of each individual tree
for (i in 1:length(sim_idx)){
tree_scale <- read.tree(paste("sim.",sim_idx[i],".tre",sep = ""))
# Rescale edge lengths
tree_scale$edge.length <- tree_scale$edge.length*10
# Rescale the stem branch length
tree_scale$root.edge   <- tree_scale$root.edge*10
# Save the modified tree
write.tree(tree_scale,paste0(out_sim_fp,"/sim.",sim_idx[i],".tre"))
}
paste0(out_sim_fp,"/sim.",sim_idx[i],".tre")
sim_idx[1]
sim_idx
# Get indexes from all tree files that exist in the folder
for (i in 1:length(sim_files)){
if(file.exists(sim_files[i]) == TRUE){
sim_idx <- append(sim_idx,i)
} else {
next
}
}
sim_files
# Load packages
library(ape)
########################
##### FILE SYSTEM ######
########################
fp = "/Users/albertsoewongsono/Documents/Code Testing/visitor_sse"
# out_sim_fp = paste0(fp,"/data/sim7_rescale")  # dataset 7 rescaled
out_sim_fp = paste0(fp,"/data/sim7_rescale100")  # dataset 7 rescaled by 100
rep_idx = 1:350
sim_files = paste0(out_sim_fp, "/sim.", rep_idx, ".tre")
sim_idx = c()
# Get indexes from all tree files that exist in the folder
for (i in 1:length(sim_files)){
if(file.exists(sim_files[i]) == TRUE){
sim_idx <- append(sim_idx,i)
} else {
next
}
}
# Rescale all branch lengths of each individual tree
for (i in 1:length(sim_idx)){
tree_scale <- read.tree(paste("sim.",sim_idx[i],".tre",sep = ""))
# Rescale edge lengths
tree_scale$edge.length <- tree_scale$edge.length*10
# Rescale the stem branch length
tree_scale$root.edge   <- tree_scale$root.edge*10
# Save the modified tree
write.tree(tree_scale,paste0(out_sim_fp,"/sim.",sim_idx[i],".tre"))
}
# Load packages
library(ape)
########################
##### FILE SYSTEM ######
########################
fp = "/Users/albertsoewongsono/Documents/Code Testing/visitor_sse"
# out_sim_fp = paste0(fp,"/data/sim7_rescale")  # dataset 7 rescaled
out_sim_fp = paste0(fp,"/data/sim7_rescale100")  # dataset 7 rescaled by 100
rep_idx = 1:350
sim_files = paste0(out_sim_fp, "/sim.", rep_idx, ".tre")
sim_idx = c()
# Get indexes from all tree files that exist in the folder
for (i in 1:length(sim_files)){
if(file.exists(sim_files[i]) == TRUE){
sim_idx <- append(sim_idx,i)
} else {
next
}
}
# Rescale all branch lengths of each individual tree
for (i in 1:length(sim_idx)){
tree_scale <- read.tree(paste("sim.",sim_idx[i],".tre",sep = ""))
# Rescale edge lengths
# tree_scale$edge.length <- tree_scale$edge.length*10
tree_scale$edge.length <- tree_scale$edge.length*100
# Rescale the stem branch length
# tree_scale$root.edge   <- tree_scale$root.edge*10
tree_scale$root.edge   <- tree_scale$root.edge*100
# Save the modified tree
write.tree(tree_scale,paste0(out_sim_fp,"/sim.",sim_idx[i],".tre"))
}
696/6
0.6162675618/(0.6162675618+0.1918662191+0.1918662191)
0.6162675618/(0.6162675618+0.1918662191+0.1918662191+0.1918662191+0.6162675618+0.1918662191+0.1918662191+0.1918662191+0.6162675618)
0.1918662191/(0.6162675618+0.1918662191+0.1918662191+0.1918662191+0.6162675618+0.1918662191+0.1918662191+0.1918662191+0.6162675618)
0.5^3 > 0.5^2
(log(1)+1)^1.5602161559665417
0.577395314677126*2
1.154791*2
2*0.849164512239426
2*0.849164512239426*2
wa=0.17708269491205803*(log(2)+1)^(-1.3090723925904808)
wa
ea=0.6279037208665429*(log(2)+1)^(-1.1919106421822416)
ea
wb=0.17708269491205803*(log(1)+1)^(-1.3090723925904808)
wb
wc = 0
eb=0.6279037208665429*(log(1)+1)^(-1.1919106421822416)
ec=0
dab = 0.350451239891875*(log(2)+1)^(0.6945807511638916)*(log(1+1)+1)^( 1.4054346588770847)
dab
dac = 0.350451239891875*(log(2)+1)^(0.6945807511638916)*(log(0+1)+1)^( 1.4054346588770847)
dba = 0.350451239891875*(log(1)+1)^(0.6945807511638916)*(log(2+1)+1)^( 1.4054346588770847)
dbc = 0.350451239891875*(log(1)+1)^(0.6945807511638916)*(log(0+1)+1)^( 1.4054346588770847)
dca = 0
dcb=0
bab = 0.9165258706490482*(1/((log(2*1)+1)^0.4193893872813052 + (log(2*1)+1)^0.4193893872813052)/2)^(-1)
bab
bac = 0
bbc = 0
babc=0
bbac = 0
bcab = 0
2*(wa+ea+dab+dac)+1*(wb+eb+dba+dbc)+0*(2)+1*(wa+wb+ea+eb+dac+dbc+bab)
0.35484029769203+1.298312034909252+3.6520307823160536
+1.1430279845506994
bab
bab = 0.9165258706490482*((((log(2*1)+1)^0.4193893872813052 + (log(2*1)+1)^0.4193893872813052)/2)^(-1))^(-1)
bab
2*(wa+ea+dab+dac)+1*(wb+eb+dba+dbc)+0*(2)+1*(wa+wb+ea+eb+dac+dbc+bab)
1*(wa+ea+dab+dac)+0*(wb+eb+dba+dbc)+0*(2)+1*(wa+wb+ea+eb+dac+dbc+bab)
wa+wa+wb
ea+ea+eb
dab+dac+dac+dbc
dab
dab = 0.350451239891875*((log(2)+1)^(0.6945807511638916)+(log(1+1)+1)^( 1.4054346588770847))
dab
dac = 0.350451239891875*((log(2)+1)^(0.6945807511638916)+(log(0+1)+1)^( 1.4054346588770847))
dba = 0.350451239891875*((log(1)+1)^(0.6945807511638916)+(log(2+1)+1)^( 1.4054346588770847))
dbc = 0.350451239891875*((log(1)+1)^(0.6945807511638916)+(log(0+1)+1)^( 1.4054346588770847))
dab+dac+dac+dbc
1*(wa+ea+dab+dac)+0*(wb+eb+dba+dbc)+0*(2)+1*(wa+wb+ea+eb+dac+dbc+bab)
0.35484029769203+1.298312034909252+3.6520307823160536+1.1430279845506994
812/7
798/7
805/7
812/7
798/7
2*0.01/4
(2*0.01/4)*4
0.01*2
sample_event = function(rates) {
probs = rates / sum(rates)
u = runif(1,0,1)
my_prob = u
my_event = NA
for (i in 1:length(probs)) {
# consider event i
u = u - probs[i]
# did u fall within prob. interval for i
if (u < 0) {
# yes!
my_event = names(rates)[i]
return(my_event)
# or you could use break
}
# inspect next event if we do not return/break
}
}
rates = c(A=4, B=1, C=5)[ c(3,2,1) ]
rates
N      = c( 3, 2 )
lambda = c( 4, 3 )
mu     = c( 2, 1 )
q      = c( 5, 6 )
# rates per state per species
r = rbind(lambda, mu, q)
r
m = t(N * t(r))
m
N * t(r)
N
t(r)
colnames(m) = c("A", "B")
m
rates = c(m)
names(rates) = c( paste0(rownames(m),"_A"), paste0(rownames(m),"_B") )
rates
my_events = c()
for (i in 1:100000) {
my_events[i] = sample_event(rates)
}
table(my_events) / length(my_events)
my_events = c()
for (i in 1:100000) {
my_events[i] = sample_event(rates)
}
my_events
my_events[``]
my_events[``]
my_events[1]
rates
sum(rates)
15/53
table(my_events) / length(my_events)
sample(x=LETTERS[1:2], prob=N, size=5, replace=T)
sample(x=LETTERS[1:2], prob=N, size=5, replace=T)
N
r
m
rates
m
c(m)
1100-302.61
3900-200-1600
2100-1000
1100-200
library(devtools)
install_github("GuangchuangYu/ggtree")
library(RevGadgets)
install_github("revbayes/RevGadgets")
library(RevGadgets)
tree_file = "/Users/albertsoewongsono/Documents/Code Testing/visitor_sse/output/logs/A2/ase_A2.tree"
g <- plot_ancestral_states(tree_file, summary_statistic="MAP",
tip_label_size=1,
xlim_visible=NULL,
node_label_size=0,
show_posterior_legend=FALSE,
node_size_range=c(2.5, 2.5),
alpha=0.75)
install_github("GuangchuangYu/ggtree")
library(ggtree)
g <- plot_ancestral_states(tree_file, summary_statistic="MAP",
tip_label_size=1,
xlim_visible=NULL,
node_label_size=0,
show_posterior_legend=FALSE,
node_size_range=c(2.5, 2.5),
alpha=0.75)
g <- plotAncStatesMAP(tree_file)
library(devtools)
library(ggplot2)
library(RevGadgets)
?ggplot2
tree_file = "/Users/albertsoewongsono/Documents/Code Testing/visitor_sse/output/logs/A2/ase_A2.tree"
g <- plot_ancestral_states(tree_file, summary_statistic="MAP",
tip_label_size=1,
xlim_visible=NULL,
node_label_size=0,
show_posterior_legend=FALSE,
node_size_range=c(2.5, 2.5),
alpha=0.75)
example <- processAncStates(tree_file,
state_labels = c("1" = "Hubei",
"2" = "France",
"3" = "Germany",
"4" = "Italy",
"5" = "Other European"))
185/5
